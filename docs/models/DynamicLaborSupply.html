<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.40">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>A Simple Labor Supply Model – Econ8502</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script><script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-549806ee2085284f45b00abea8c6df48.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-6bd9cfa162949bde0a231f530c97869d.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" integrity="sha512-c3Nl8+7g4LMSTdrm621y7kf9v3SDPnhxLNhcjFJbKECVnmZHTdo+IRO05sNLTH/D3vA6u1X32ehoLC7WFVdheg==" crossorigin="anonymous"></script>

<script type="application/javascript">define('jquery', [],function() {return window.jQuery;})</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Econ8502</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-assignments" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Assignments</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-assignments">    
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-1.html">
 <span class="dropdown-text">Assignment 1</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-2.html">
 <span class="dropdown-text">Assignment 2</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-3.html">
 <span class="dropdown-text">Assignment 3</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-4.html">
 <span class="dropdown-text">Assignment 4</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-5.html">
 <span class="dropdown-text">Assignment 5</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../assignments/Assignment-6.html">
 <span class="dropdown-text">Assignment 6</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-examples" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Examples</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-examples">    
        <li>
    <a class="dropdown-item" href="../examples/LeastSquaresClustering.html">
 <span class="dropdown-text">Clustering with Coefficients</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-models" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Models</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-models">    
        <li>
    <a class="dropdown-item" href="../models/DynamicLaborSupply.html">
 <span class="dropdown-text">A Simple Labor Supply Model</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#model-setup-and-solution" id="toc-model-setup-and-solution" class="nav-link active" data-scroll-target="#model-setup-and-solution">Model Setup and Solution</a></li>
  <li><a href="#code-to-solve-the-model" id="toc-code-to-solve-the-model" class="nav-link" data-scroll-target="#code-to-solve-the-model">Code to solve the model</a></li>
  <li><a href="#code-to-simulate-a-cross-section" id="toc-code-to-simulate-a-cross-section" class="nav-link" data-scroll-target="#code-to-simulate-a-cross-section">Code to simulate a cross-section</a></li>
  <li><a href="#simulating-bias-in-ols" id="toc-simulating-bias-in-ols" class="nav-link" data-scroll-target="#simulating-bias-in-ols">Simulating bias in OLS</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">A Simple Labor Supply Model</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<section id="model-setup-and-solution" class="level2">
<h2 class="anchored" data-anchor-id="model-setup-and-solution">Model Setup and Solution</h2>
<p>Consider a dynamic labor supply model (with no uncertainty) where each agent <span class="math inline">\(n\)</span> chooses a sequence of consumption and hours, <span class="math inline">\(\{c_{t},h_{t}\}_{t=1}^{\infty}\)</span>, to solve: <span class="math display">\[ \max \sum_{t=0}^\infty \beta^{t} \left(\frac{c_{t}^{1-\sigma}}{1-\sigma} - \frac{\alpha_{n}^{-1}}{1 + 1/\psi}h_{t}^{1+1/\psi}\right)\]</span> subject to the intertemporal budget constraint: <span class="math display">\[ \sum_{t}q_{t}c_{t} \leq A_{n,0} + \sum_{t}q_{t}W_{n,t}h_{t},\qquad q_{t} = (1+r)^{-t}.\]</span> Let <span class="math inline">\(H_{n,t}\)</span> and <span class="math inline">\(C_{n,t}\)</span> be the realizations of labor supply for agent <span class="math inline">\(n\)</span> at time <span class="math inline">\(t\)</span>. Labor supply in this model obeys: <span class="math display">\[H_{n,t}^{1/\psi} = (\alpha_{n}W_{n,t})C^{-\sigma}_{n,t}.\]</span> To simplify below, assume that <span class="math inline">\(\beta=(1+r)^{-1}\)</span>, so that the optimal solution features perfectly smoothed consumption, <span class="math inline">\(C^*_{n}\)</span>. Making appropriate substitutions gives <span class="math inline">\(C^*_{n}\)</span> as the solution to: <span class="math display">\[ \left(\sum_{t}q_{t}\right)C^*_{n} = \sum_{t}\left(q_{t}W_{n,t}^{1+\psi}\right)\alpha_{n}^{\psi}(C^*)^{-\psi\sigma}_{n} + A_{n,0}.\]</span></p>
</section>
<section id="code-to-solve-the-model" class="level2">
<h2 class="anchored" data-anchor-id="code-to-solve-the-model">Code to solve the model</h2>
<p>There is only one object to solve here which is consumption given a sequence of net wages. If one were to assume also constant wages (or net ages in the case of <a href="../assignments/Assignment-2.html">Assignment 2</a>, the function below solves optimal consumption.</p>
<div id="5bf682ff" class="cell" data-execution_count="1">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Optim</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">solve_consumption</span>(r,α,W,A,σ,ψ)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>    Q <span class="op">=</span> <span class="fl">1</span><span class="op">/</span> (<span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span>(<span class="fl">1</span><span class="op">+</span>r))</span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">f</span>(c) <span class="op">=</span> (Q <span class="op">*</span> c <span class="op">-</span> Q <span class="op">*</span> W<span class="op">^</span>(<span class="fl">1</span> <span class="op">+</span> ψ) <span class="op">*</span> α<span class="op">^</span>ψ <span class="op">*</span> c<span class="op">^</span>(<span class="op">-</span>σ<span class="op">*</span>ψ) <span class="op">-</span> A)<span class="op">^</span><span class="fl">2</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    r <span class="op">=</span> Optim.<span class="fu">optimize</span>(f,<span class="fl">0</span>.,A<span class="op">+</span>W)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> r.minimizer</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>solve_consumption (generic function with 1 method)</code></pre>
</div>
</div>
</section>
<section id="code-to-simulate-a-cross-section" class="level2">
<h2 class="anchored" data-anchor-id="code-to-simulate-a-cross-section">Code to simulate a cross-section</h2>
<p>Here we’ll assume that wages, tastes for work, and assets co-vary systematically. For simplicity we’ll use a multivariate log-normal distribution.</p>
<p>Below is code to simulate a cross-section of 1,000 observations.</p>
<div id="412bae1a" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Distributions</span></span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">simulate_data</span>(σ,ψ,r,N)</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    ch <span class="op">=</span> [<span class="fl">1</span>. <span class="fl">0</span>. <span class="fl">0</span>.; <span class="fl">0.4</span> <span class="fl">0.9</span> <span class="fl">0</span>.; <span class="fl">0.4</span> <span class="fl">1.1</span> <span class="fl">3.1</span>]</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">#ch = [1. 0. 0.; 0. 1. 0.; 0. 0. 3.1]</span></span>
<span id="cb3-5"><a href="#cb3-5" aria-hidden="true" tabindex="-1"></a>    Σ <span class="op">=</span> ch <span class="op">*</span> ch<span class="op">'</span></span>
<span id="cb3-6"><a href="#cb3-6" aria-hidden="true" tabindex="-1"></a>    X <span class="op">=</span> <span class="fu">rand</span>(<span class="fu">MvNormal</span>(Σ),N)</span>
<span id="cb3-7"><a href="#cb3-7" aria-hidden="true" tabindex="-1"></a>    α <span class="op">=</span> <span class="fu">exp</span>.(X[<span class="fl">1</span>,<span class="op">:</span>])</span>
<span id="cb3-8"><a href="#cb3-8" aria-hidden="true" tabindex="-1"></a>    W <span class="op">=</span> <span class="fu">exp</span>.(X[<span class="fl">2</span>,<span class="op">:</span>])</span>
<span id="cb3-9"><a href="#cb3-9" aria-hidden="true" tabindex="-1"></a>    A <span class="op">=</span> <span class="fu">exp</span>.(X[<span class="fl">3</span>,<span class="op">:</span>])</span>
<span id="cb3-10"><a href="#cb3-10" aria-hidden="true" tabindex="-1"></a>    C <span class="op">=</span> [<span class="fu">solve_consumption</span>(r,α[i],W[i],A[i],σ,ψ) for i <span class="kw">in</span> <span class="fu">eachindex</span>(A)]</span>
<span id="cb3-11"><a href="#cb3-11" aria-hidden="true" tabindex="-1"></a>    <span class="pp">@views</span> H <span class="op">=</span> <span class="fu">exp</span>.( X[<span class="fl">1</span>,<span class="op">:</span>] <span class="op">.+</span> ψ <span class="op">.*</span> X[<span class="fl">2</span>,<span class="op">:</span>] <span class="op">.-</span> σ <span class="op">.*</span> <span class="fu">log</span>.(C) )</span>
<span id="cb3-12"><a href="#cb3-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> (;α,W,A,C,H)</span>
<span id="cb3-13"><a href="#cb3-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb3-14"><a href="#cb3-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-15"><a href="#cb3-15" aria-hidden="true" tabindex="-1"></a><span class="co"># assume risk-aversion of 2 and frisch of 0.5</span></span>
<span id="cb3-16"><a href="#cb3-16" aria-hidden="true" tabindex="-1"></a>σ <span class="op">=</span> <span class="fl">2</span>.</span>
<span id="cb3-17"><a href="#cb3-17" aria-hidden="true" tabindex="-1"></a>ψ <span class="op">=</span> <span class="fl">0.5</span></span>
<span id="cb3-18"><a href="#cb3-18" aria-hidden="true" tabindex="-1"></a>r <span class="op">=</span> <span class="fl">0.05</span></span>
<span id="cb3-19"><a href="#cb3-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-20"><a href="#cb3-20" aria-hidden="true" tabindex="-1"></a>dat <span class="op">=</span> <span class="fu">simulate_data</span>(σ,ψ,r,<span class="fl">1_000</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>(α = [0.49175818188949705, 0.986226913253896, 0.7250100065218843, 0.30048536105567936, 0.7239973590553194, 0.40096598813374373, 1.744447757665296, 7.194449163758211, 0.44527314672142576, 5.418637196679679  …  0.7656413684182118, 0.34998011438032045, 0.7108953607589309, 0.635479599228998, 12.133589347592283, 0.8690551295340709, 1.3535579603344792, 0.9399215971910277, 0.9394335947152371, 1.80973759570962], W = [6.28753931107913, 0.37227878397779157, 0.6617650277857751, 0.29389170838965767, 1.3520209268518846, 1.669019083097132, 2.7293337001222024, 2.0104281689961367, 0.611240081790339, 2.361986297456483  …  4.6542832390298665, 0.44297526677769833, 1.559367401994248, 2.949022115473027, 9.230594120083804, 6.7724328757214804, 1.3539343625757572, 0.5478073521243791, 0.515290652581293, 1.4652182073434514], A = [0.43239757772313464, 0.04249261199605109, 1571.6304082035906, 0.015253551084704175, 7.244039097629857, 0.01706677026095686, 8.371210824438649, 0.8983148473092751, 0.09952775648837497, 0.8562962547424287  …  0.8324142191200044, 19.62427759849109, 0.4078279111036236, 12.068760603473956, 0.7677568265091131, 226.40629350471647, 59.22585412298234, 0.9384014544617263, 1.8300922909625204, 1.6772131349102963], C = [3.3353630581311426, 0.41477138425488896, 74.84566761260596, 0.29588983566116783, 1.3418366928151146, 1.1688906655687026, 2.647817649250218, 2.786602792510844, 0.5670716961768936, 2.9273625600952857  …  2.9840068294932394, 1.0939307931257787, 1.2910821848784046, 2.3170448849710903, 9.90199704375127, 12.135177108179757, 3.364973533563356, 0.6497066047673189, 0.6439210687762488, 1.5851016919218668], H = [0.11084234943157625, 3.4977874972200316, 0.00010528404780428737, 1.8606166050329507, 0.4675513999778908, 0.37913196816194666, 0.4110646600322336, 1.3136863658005666, 1.082571214120396, 0.9717973998066577  …  0.18550352632863448, 0.19464955399981515, 0.532564395818934, 0.20326927302952474, 0.3759746253876645, 0.015357744699462552, 0.13909526850729864, 1.64805231509469, 1.6263984379102456, 0.8718715428082312])</code></pre>
</div>
</div>
</section>
<section id="simulating-bias-in-ols" class="level2">
<h2 class="anchored" data-anchor-id="simulating-bias-in-ols">Simulating bias in OLS</h2>
<p>We know that OLS will be biased here, but let’s run a simulation anyway to hammer the point home.</p>
<div id="9e96c2da" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a><span class="kw">function</span> <span class="fu">simulate_bias</span>(B,N,σ,ψ,r)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>    ψ_est <span class="op">=</span> <span class="fu">zeros</span>(B)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>    σ_est <span class="op">=</span> <span class="fu">zeros</span>(B)</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> b <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span>B</span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>        dat <span class="op">=</span> <span class="fu">simulate_data</span>(σ,ψ,r,N)</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a>        X <span class="op">=</span> [<span class="fu">ones</span>(N) <span class="fu">log</span>.(dat.W) <span class="fu">log</span>.(dat.C)]</span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a>        Y <span class="op">=</span> <span class="fu">log</span>.(dat.H)</span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a>        b_est <span class="op">=</span> <span class="fu">inv</span>(X<span class="op">'</span> <span class="op">*</span> X) <span class="op">*</span> X<span class="op">'</span> <span class="op">*</span> Y</span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a>        ψ_est[b] <span class="op">=</span> b_est[<span class="fl">2</span>]</span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a>        σ_est[b] <span class="op">=</span> <span class="op">-</span>b_est[<span class="fl">3</span>]</span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a>    <span class="cf">end</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span> ψ_est,σ_est</span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-15"><a href="#cb5-15" aria-hidden="true" tabindex="-1"></a>ψ_est,σ_est <span class="op">=</span> <span class="fu">simulate_bias</span>(<span class="fl">500</span>,<span class="fl">1_000</span>,σ,ψ,r)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>([0.7375213510883245, 0.663658268751816, 0.7835079243947458, 0.7364001745408151, 0.733803154948347, 0.7314688678325089, 0.8035138594385262, 0.734551559550142, 0.7108880707297295, 0.8157241472988785  …  0.7913396251116804, 0.646292933304784, 0.7175598812390721, 0.7533588893020249, 0.7104488022956886, 0.8035356263976514, 0.8003930203631324, 0.7384992135877448, 0.8032392192254386, 0.7501312932193543], [1.7733073269300241, 1.7411245963277304, 1.8511811109532395, 1.8470496967584369, 1.7919812588139807, 1.792859555400039, 1.8249165775795684, 1.7852576212177926, 1.7535921623561523, 1.853785686605331  …  1.8802867037468904, 1.7943288520766576, 1.7756741576320298, 1.8170034468067677, 1.7936039354585191, 1.848592291029117, 1.8777521914228064, 1.8151312337186112, 1.8690543243583304, 1.8045459040102632])</code></pre>
</div>
</div>
<p>Given the covariance structure, we can see a clear bias in the estimates.</p>
<div id="e3c92363" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode julia code-with-copy"><code class="sourceCode julia"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">using</span> <span class="bu">Plots</span></span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a><span class="fu">histogram</span>(ψ_est)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<!--?xml version="1.0" encoding="utf-8"?-->
<svg xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" width="672" height="480" viewbox="0 0 2688 1920">
<defs>
  <clippath id="clip430">
    <rect x="0" y="0" width="2688" height="1920"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M0 1920 L2688 1920 L2688 -4.26326e-14 L0 -4.26326e-14  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip431">
    <rect x="537" y="0" width="1883" height="1883"></rect>
  </clippath>
</defs>
<path clip-path="url(#clip430)" d="M144.062 1800.78 L2640.76 1800.78 L2640.76 47.2441 L144.062 47.2441  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<defs>
  <clippath id="clip432">
    <rect x="144" y="47" width="2498" height="1755"></rect>
  </clippath>
</defs>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="281.384,1800.78 281.384,47.2441 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1022.07,1800.78 1022.07,47.2441 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="1762.75,1800.78 1762.75,47.2441 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="2503.43,1800.78 2503.43,47.2441 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.062,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.062,1216.27 2640.76,1216.27 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.062,631.756 2640.76,631.756 "></polyline>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:2; stroke-opacity:0.1; fill:none" points="144.062,47.2441 2640.76,47.2441 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,1800.78 2640.76,1800.78 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.384,1800.78 281.384,1781.88 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1022.07,1800.78 1022.07,1781.88 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1762.75,1800.78 1762.75,1781.88 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2503.43,1800.78 2503.43,1781.88 "></polyline>
<path clip-path="url(#clip430)" d="M258.688 1834 Q255.077 1834 253.248 1837.57 Q251.442 1841.11 251.442 1848.24 Q251.442 1855.34 253.248 1858.91 Q255.077 1862.45 258.688 1862.45 Q262.322 1862.45 264.127 1858.91 Q265.956 1855.34 265.956 1848.24 Q265.956 1841.11 264.127 1837.57 Q262.322 1834 258.688 1834 M258.688 1830.3 Q264.498 1830.3 267.553 1834.9 Q270.632 1839.49 270.632 1848.24 Q270.632 1856.96 267.553 1861.57 Q264.498 1866.15 258.688 1866.15 Q252.877 1866.15 249.799 1861.57 Q246.743 1856.96 246.743 1848.24 Q246.743 1839.49 249.799 1834.9 Q252.877 1830.3 258.688 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M278.85 1859.6 L283.734 1859.6 L283.734 1865.48 L278.85 1865.48 L278.85 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M304.498 1846.34 Q301.349 1846.34 299.498 1848.49 Q297.669 1850.65 297.669 1854.4 Q297.669 1858.12 299.498 1860.3 Q301.349 1862.45 304.498 1862.45 Q307.646 1862.45 309.474 1860.3 Q311.326 1858.12 311.326 1854.4 Q311.326 1850.65 309.474 1848.49 Q307.646 1846.34 304.498 1846.34 M313.78 1831.69 L313.78 1835.95 Q312.021 1835.11 310.215 1834.67 Q308.433 1834.23 306.673 1834.23 Q302.044 1834.23 299.59 1837.36 Q297.16 1840.48 296.812 1846.8 Q298.178 1844.79 300.238 1843.72 Q302.299 1842.64 304.775 1842.64 Q309.984 1842.64 312.993 1845.81 Q316.025 1848.96 316.025 1854.4 Q316.025 1859.72 312.877 1862.94 Q309.729 1866.15 304.498 1866.15 Q298.502 1866.15 295.331 1861.57 Q292.16 1856.96 292.16 1848.24 Q292.16 1840.04 296.049 1835.18 Q299.937 1830.3 306.488 1830.3 Q308.248 1830.3 310.03 1830.65 Q311.836 1830.99 313.78 1831.69 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M999.903 1834 Q996.292 1834 994.463 1837.57 Q992.658 1841.11 992.658 1848.24 Q992.658 1855.34 994.463 1858.91 Q996.292 1862.45 999.903 1862.45 Q1003.54 1862.45 1005.34 1858.91 Q1007.17 1855.34 1007.17 1848.24 Q1007.17 1841.11 1005.34 1837.57 Q1003.54 1834 999.903 1834 M999.903 1830.3 Q1005.71 1830.3 1008.77 1834.9 Q1011.85 1839.49 1011.85 1848.24 Q1011.85 1856.96 1008.77 1861.57 Q1005.71 1866.15 999.903 1866.15 Q994.093 1866.15 991.014 1861.57 Q987.959 1856.96 987.959 1848.24 Q987.959 1839.49 991.014 1834.9 Q994.093 1830.3 999.903 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1020.06 1859.6 L1024.95 1859.6 L1024.95 1865.48 L1020.06 1865.48 L1020.06 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1033.95 1830.92 L1056.18 1830.92 L1056.18 1832.91 L1043.63 1865.48 L1038.75 1865.48 L1050.55 1834.86 L1033.95 1834.86 L1033.95 1830.92 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1740.18 1834 Q1736.57 1834 1734.74 1837.57 Q1732.94 1841.11 1732.94 1848.24 Q1732.94 1855.34 1734.74 1858.91 Q1736.57 1862.45 1740.18 1862.45 Q1743.82 1862.45 1745.62 1858.91 Q1747.45 1855.34 1747.45 1848.24 Q1747.45 1841.11 1745.62 1837.57 Q1743.82 1834 1740.18 1834 M1740.18 1830.3 Q1745.99 1830.3 1749.05 1834.9 Q1752.13 1839.49 1752.13 1848.24 Q1752.13 1856.96 1749.05 1861.57 Q1745.99 1866.15 1740.18 1866.15 Q1734.37 1866.15 1731.29 1861.57 Q1728.24 1856.96 1728.24 1848.24 Q1728.24 1839.49 1731.29 1834.9 Q1734.37 1830.3 1740.18 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1760.34 1859.6 L1765.23 1859.6 L1765.23 1865.48 L1760.34 1865.48 L1760.34 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M1785.41 1849.07 Q1782.08 1849.07 1780.16 1850.85 Q1778.26 1852.64 1778.26 1855.76 Q1778.26 1858.89 1780.16 1860.67 Q1782.08 1862.45 1785.41 1862.45 Q1788.75 1862.45 1790.67 1860.67 Q1792.59 1858.86 1792.59 1855.76 Q1792.59 1852.64 1790.67 1850.85 Q1788.77 1849.07 1785.41 1849.07 M1780.74 1847.08 Q1777.73 1846.34 1776.04 1844.28 Q1774.37 1842.22 1774.37 1839.26 Q1774.37 1835.11 1777.31 1832.71 Q1780.27 1830.3 1785.41 1830.3 Q1790.57 1830.3 1793.51 1832.71 Q1796.45 1835.11 1796.45 1839.26 Q1796.45 1842.22 1794.76 1844.28 Q1793.1 1846.34 1790.11 1847.08 Q1793.49 1847.87 1795.37 1850.16 Q1797.26 1852.45 1797.26 1855.76 Q1797.26 1860.78 1794.19 1863.47 Q1791.13 1866.15 1785.41 1866.15 Q1779.69 1866.15 1776.62 1863.47 Q1773.56 1860.78 1773.56 1855.76 Q1773.56 1852.45 1775.46 1850.16 Q1777.36 1847.87 1780.74 1847.08 M1779.02 1839.7 Q1779.02 1842.38 1780.69 1843.89 Q1782.38 1845.39 1785.41 1845.39 Q1788.42 1845.39 1790.11 1843.89 Q1791.82 1842.38 1791.82 1839.7 Q1791.82 1837.01 1790.11 1835.51 Q1788.42 1834 1785.41 1834 Q1782.38 1834 1780.69 1835.51 Q1779.02 1837.01 1779.02 1839.7 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2480.91 1834 Q2477.3 1834 2475.47 1837.57 Q2473.66 1841.11 2473.66 1848.24 Q2473.66 1855.34 2475.47 1858.91 Q2477.3 1862.45 2480.91 1862.45 Q2484.54 1862.45 2486.35 1858.91 Q2488.18 1855.34 2488.18 1848.24 Q2488.18 1841.11 2486.35 1837.57 Q2484.54 1834 2480.91 1834 M2480.91 1830.3 Q2486.72 1830.3 2489.78 1834.9 Q2492.85 1839.49 2492.85 1848.24 Q2492.85 1856.96 2489.78 1861.57 Q2486.72 1866.15 2480.91 1866.15 Q2475.1 1866.15 2472.02 1861.57 Q2468.97 1856.96 2468.97 1848.24 Q2468.97 1839.49 2472.02 1834.9 Q2475.1 1830.3 2480.91 1830.3 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2501.07 1859.6 L2505.96 1859.6 L2505.96 1865.48 L2501.07 1865.48 L2501.07 1859.6 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2516.28 1864.77 L2516.28 1860.51 Q2518.04 1861.34 2519.85 1861.78 Q2521.65 1862.22 2523.39 1862.22 Q2528.02 1862.22 2530.45 1859.12 Q2532.9 1855.99 2533.25 1849.65 Q2531.91 1851.64 2529.85 1852.71 Q2527.78 1853.77 2525.29 1853.77 Q2520.1 1853.77 2517.07 1850.65 Q2514.06 1847.5 2514.06 1842.06 Q2514.06 1836.73 2517.21 1833.52 Q2520.35 1830.3 2525.59 1830.3 Q2531.58 1830.3 2534.73 1834.9 Q2537.9 1839.49 2537.9 1848.24 Q2537.9 1856.41 2534.01 1861.29 Q2530.15 1866.15 2523.6 1866.15 Q2521.84 1866.15 2520.03 1865.81 Q2518.22 1865.46 2516.28 1864.77 M2525.59 1850.11 Q2528.73 1850.11 2530.56 1847.96 Q2532.41 1845.81 2532.41 1842.06 Q2532.41 1838.33 2530.56 1836.18 Q2528.73 1834 2525.59 1834 Q2522.44 1834 2520.59 1836.18 Q2518.76 1838.33 2518.76 1842.06 Q2518.76 1845.81 2520.59 1847.96 Q2522.44 1850.11 2525.59 1850.11 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,1800.78 144.062,47.2441 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,1800.78 162.959,1800.78 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,1216.27 162.959,1216.27 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,631.756 162.959,631.756 "></polyline>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="144.062,47.2441 162.959,47.2441 "></polyline>
<path clip-path="url(#clip430)" d="M91.7973 1786.58 Q88.1862 1786.58 86.3575 1790.14 Q84.5519 1793.68 84.5519 1800.81 Q84.5519 1807.92 86.3575 1811.49 Q88.1862 1815.03 91.7973 1815.03 Q95.4315 1815.03 97.2371 1811.49 Q99.0657 1807.92 99.0657 1800.81 Q99.0657 1793.68 97.2371 1790.14 Q95.4315 1786.58 91.7973 1786.58 M91.7973 1782.87 Q97.6074 1782.87 100.663 1787.48 Q103.742 1792.06 103.742 1800.81 Q103.742 1809.54 100.663 1814.15 Q97.6074 1818.73 91.7973 1818.73 Q85.9871 1818.73 82.9084 1814.15 Q79.8529 1809.54 79.8529 1800.81 Q79.8529 1792.06 82.9084 1787.48 Q85.9871 1782.87 91.7973 1782.87 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M65.802 1214.91 Q69.1585 1215.63 71.0335 1217.9 Q72.9316 1220.17 72.9316 1223.5 Q72.9316 1228.62 69.4131 1231.42 Q65.8946 1234.22 59.4132 1234.22 Q57.2373 1234.22 54.9225 1233.78 Q52.6308 1233.36 50.1771 1232.51 L50.1771 1227.99 Q52.1216 1229.13 54.4364 1229.7 Q56.7512 1230.28 59.2743 1230.28 Q63.6724 1230.28 65.9641 1228.55 Q68.2789 1226.81 68.2789 1223.5 Q68.2789 1220.45 66.1261 1218.73 Q63.9965 1217 60.1771 1217 L56.1493 1217 L56.1493 1213.15 L60.3623 1213.15 Q63.8113 1213.15 65.64 1211.79 Q67.4687 1210.4 67.4687 1207.81 Q67.4687 1205.14 65.5706 1203.73 Q63.6956 1202.3 60.1771 1202.3 Q58.2558 1202.3 56.0567 1202.71 Q53.8577 1203.13 51.2188 1204.01 L51.2188 1199.84 Q53.8808 1199.1 56.1956 1198.73 Q58.5336 1198.36 60.5937 1198.36 Q65.9178 1198.36 69.0196 1200.79 Q72.1214 1203.2 72.1214 1207.32 Q72.1214 1210.19 70.4779 1212.18 Q68.8344 1214.15 65.802 1214.91 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M91.7973 1202.07 Q88.1862 1202.07 86.3575 1205.63 Q84.5519 1209.17 84.5519 1216.3 Q84.5519 1223.41 86.3575 1226.97 Q88.1862 1230.52 91.7973 1230.52 Q95.4315 1230.52 97.2371 1226.97 Q99.0657 1223.41 99.0657 1216.3 Q99.0657 1209.17 97.2371 1205.63 Q95.4315 1202.07 91.7973 1202.07 M91.7973 1198.36 Q97.6074 1198.36 100.663 1202.97 Q103.742 1207.55 103.742 1216.3 Q103.742 1225.03 100.663 1229.64 Q97.6074 1234.22 91.7973 1234.22 Q85.9871 1234.22 82.9084 1229.64 Q79.8529 1225.03 79.8529 1216.3 Q79.8529 1207.55 82.9084 1202.97 Q85.9871 1198.36 91.7973 1198.36 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M62.2141 629.892 Q59.066 629.892 57.2141 632.045 Q55.3854 634.198 55.3854 637.948 Q55.3854 641.675 57.2141 643.851 Q59.066 646.003 62.2141 646.003 Q65.3622 646.003 67.1909 643.851 Q69.0428 641.675 69.0428 637.948 Q69.0428 634.198 67.1909 632.045 Q65.3622 629.892 62.2141 629.892 M71.4965 615.24 L71.4965 619.499 Q69.7372 618.666 67.9317 618.226 Q66.1493 617.786 64.39 617.786 Q59.7604 617.786 57.3067 620.911 Q54.8762 624.036 54.529 630.355 Q55.8947 628.341 57.9549 627.277 Q60.015 626.189 62.4919 626.189 Q67.7002 626.189 70.7094 629.36 Q73.7418 632.508 73.7418 637.948 Q73.7418 643.272 70.5937 646.49 Q67.4455 649.707 62.2141 649.707 Q56.2188 649.707 53.0475 645.124 Q49.8762 640.517 49.8762 631.791 Q49.8762 623.596 53.7651 618.735 Q57.6539 613.851 64.2048 613.851 Q65.9641 613.851 67.7465 614.198 Q69.552 614.545 71.4965 615.24 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M91.7973 617.555 Q88.1862 617.555 86.3575 621.119 Q84.5519 624.661 84.5519 631.791 Q84.5519 638.897 86.3575 642.462 Q88.1862 646.003 91.7973 646.003 Q95.4315 646.003 97.2371 642.462 Q99.0657 638.897 99.0657 631.791 Q99.0657 624.661 97.2371 621.119 Q95.4315 617.555 91.7973 617.555 M91.7973 613.851 Q97.6074 613.851 100.663 618.457 Q103.742 623.041 103.742 631.791 Q103.742 640.517 100.663 645.124 Q97.6074 649.707 91.7973 649.707 Q85.9871 649.707 82.9084 645.124 Q79.8529 640.517 79.8529 631.791 Q79.8529 623.041 82.9084 618.457 Q85.9871 613.851 91.7973 613.851 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M51.7743 63.8065 L51.7743 59.5473 Q53.5336 60.3806 55.3391 60.8204 Q57.1447 61.2602 58.8808 61.2602 Q63.5104 61.2602 65.9409 58.1584 Q68.3946 55.0334 68.7418 48.6908 Q67.3993 50.6816 65.3391 51.7464 Q63.2789 52.8112 60.7789 52.8112 Q55.5938 52.8112 52.5614 49.6862 Q49.5521 46.5381 49.5521 41.0983 Q49.5521 35.7742 52.7003 32.5567 Q55.8484 29.3391 61.0798 29.3391 Q67.0752 29.3391 70.2233 33.9456 Q73.3946 38.5289 73.3946 47.2788 Q73.3946 55.4501 69.5057 60.3343 Q65.64 65.1954 59.0891 65.1954 Q57.3299 65.1954 55.5243 64.8482 Q53.7188 64.5009 51.7743 63.8065 M61.0798 49.1538 Q64.228 49.1538 66.0567 47.001 Q67.9085 44.8483 67.9085 41.0983 Q67.9085 37.3715 66.0567 35.2187 Q64.228 33.0428 61.0798 33.0428 Q57.9317 33.0428 56.0799 35.2187 Q54.2512 37.3715 54.2512 41.0983 Q54.2512 44.8483 56.0799 47.001 Q57.9317 49.1538 61.0798 49.1538 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M91.7973 33.0428 Q88.1862 33.0428 86.3575 36.6076 Q84.5519 40.1492 84.5519 47.2788 Q84.5519 54.3853 86.3575 57.9501 Q88.1862 61.4917 91.7973 61.4917 Q95.4315 61.4917 97.2371 57.9501 Q99.0657 54.3853 99.0657 47.2788 Q99.0657 40.1492 97.2371 36.6076 Q95.4315 33.0428 91.7973 33.0428 M91.7973 29.3391 Q97.6074 29.3391 100.663 33.9456 Q103.742 38.5289 103.742 47.2788 Q103.742 56.0056 100.663 60.6121 Q97.6074 65.1954 91.7973 65.1954 Q85.9871 65.1954 82.9084 60.6121 Q79.8529 56.0056 79.8529 47.2788 Q79.8529 38.5289 82.9084 33.9456 Q85.9871 29.3391 91.7973 29.3391 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip432)" d="M281.384 1742.33 L281.384 1800.78 L429.521 1800.78 L429.521 1742.33 L281.384 1742.33 L281.384 1742.33  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="281.384,1742.33 281.384,1800.78 429.521,1800.78 429.521,1742.33 281.384,1742.33 "></polyline>
<path clip-path="url(#clip432)" d="M429.521 1722.84 L429.521 1800.78 L577.657 1800.78 L577.657 1722.84 L429.521 1722.84 L429.521 1722.84  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="429.521,1722.84 429.521,1800.78 577.657,1800.78 577.657,1722.84 429.521,1722.84 "></polyline>
<path clip-path="url(#clip432)" d="M577.657 1644.91 L577.657 1800.78 L725.794 1800.78 L725.794 1644.91 L577.657 1644.91 L577.657 1644.91  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="577.657,1644.91 577.657,1800.78 725.794,1800.78 725.794,1644.91 577.657,1644.91 "></polyline>
<path clip-path="url(#clip432)" d="M725.794 1372.14 L725.794 1800.78 L873.931 1800.78 L873.931 1372.14 L725.794 1372.14 L725.794 1372.14  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="725.794,1372.14 725.794,1800.78 873.931,1800.78 873.931,1372.14 725.794,1372.14 "></polyline>
<path clip-path="url(#clip432)" d="M873.931 1099.37 L873.931 1800.78 L1022.07 1800.78 L1022.07 1099.37 L873.931 1099.37 L873.931 1099.37  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="873.931,1099.37 873.931,1800.78 1022.07,1800.78 1022.07,1099.37 873.931,1099.37 "></polyline>
<path clip-path="url(#clip432)" d="M1022.07 787.626 L1022.07 1800.78 L1170.2 1800.78 L1170.2 787.626 L1022.07 787.626 L1022.07 787.626  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1022.07,787.626 1022.07,1800.78 1170.2,1800.78 1170.2,787.626 1022.07,787.626 "></polyline>
<path clip-path="url(#clip432)" d="M1170.2 164.146 L1170.2 1800.78 L1318.34 1800.78 L1318.34 164.146 L1170.2 164.146 L1170.2 164.146  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1170.2,164.146 1170.2,1800.78 1318.34,1800.78 1318.34,164.146 1170.2,164.146 "></polyline>
<path clip-path="url(#clip432)" d="M1318.34 320.016 L1318.34 1800.78 L1466.48 1800.78 L1466.48 320.016 L1318.34 320.016 L1318.34 320.016  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1318.34,320.016 1318.34,1800.78 1466.48,1800.78 1466.48,320.016 1318.34,320.016 "></polyline>
<path clip-path="url(#clip432)" d="M1466.48 47.2441 L1466.48 1800.78 L1614.61 1800.78 L1614.61 47.2441 L1466.48 47.2441 L1466.48 47.2441  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1466.48,47.2441 1466.48,1800.78 1614.61,1800.78 1614.61,47.2441 1466.48,47.2441 "></polyline>
<path clip-path="url(#clip432)" d="M1614.61 748.658 L1614.61 1800.78 L1762.75 1800.78 L1762.75 748.658 L1614.61 748.658 L1614.61 748.658  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1614.61,748.658 1614.61,1800.78 1762.75,1800.78 1762.75,748.658 1614.61,748.658 "></polyline>
<path clip-path="url(#clip432)" d="M1762.75 1001.95 L1762.75 1800.78 L1910.89 1800.78 L1910.89 1001.95 L1762.75 1001.95 L1762.75 1001.95  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1762.75,1001.95 1762.75,1800.78 1910.89,1800.78 1910.89,1001.95 1762.75,1001.95 "></polyline>
<path clip-path="url(#clip432)" d="M1910.89 1391.62 L1910.89 1800.78 L2059.02 1800.78 L2059.02 1391.62 L1910.89 1391.62 L1910.89 1391.62  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="1910.89,1391.62 1910.89,1800.78 2059.02,1800.78 2059.02,1391.62 1910.89,1391.62 "></polyline>
<path clip-path="url(#clip432)" d="M2059.02 1664.39 L2059.02 1800.78 L2207.16 1800.78 L2207.16 1664.39 L2059.02 1664.39 L2059.02 1664.39  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2059.02,1664.39 2059.02,1800.78 2207.16,1800.78 2207.16,1664.39 2059.02,1664.39 "></polyline>
<path clip-path="url(#clip432)" d="M2207.16 1781.3 L2207.16 1800.78 L2355.3 1800.78 L2355.3 1781.3 L2207.16 1781.3 L2207.16 1781.3  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2207.16,1781.3 2207.16,1800.78 2355.3,1800.78 2355.3,1781.3 2207.16,1781.3 "></polyline>
<path clip-path="url(#clip432)" d="M2355.3 1781.3 L2355.3 1800.78 L2503.43 1800.78 L2503.43 1781.3 L2355.3 1781.3 L2355.3 1781.3  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip432)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2355.3,1781.3 2355.3,1800.78 2503.43,1800.78 2503.43,1781.3 2355.3,1781.3 "></polyline>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="355.453" cy="1742.33" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="503.589" cy="1722.84" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="651.726" cy="1644.91" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="799.862" cy="1372.14" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="947.999" cy="1099.37" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1096.14" cy="787.626" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1244.27" cy="164.146" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1392.41" cy="320.016" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1540.55" cy="47.2441" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1688.68" cy="748.658" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1836.82" cy="1001.95" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="1984.96" cy="1391.62" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2133.09" cy="1664.39" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2281.23" cy="1781.3" r="2"></circle>
<circle clip-path="url(#clip432)" style="fill:#009af9; stroke:none; fill-opacity:0" cx="2429.36" cy="1781.3" r="2"></circle>
<path clip-path="url(#clip430)" d="M2255.43 209.375 L2557.53 209.375 L2557.53 105.695 L2255.43 105.695  Z" fill="#ffffff" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2255.43,209.375 2557.53,209.375 2557.53,105.695 2255.43,105.695 2255.43,209.375 "></polyline>
<path clip-path="url(#clip430)" d="M2283.17 178.271 L2449.62 178.271 L2449.62 136.799 L2283.17 136.799 L2283.17 178.271  Z" fill="#009af9" fill-rule="evenodd" fill-opacity="1"></path>
<polyline clip-path="url(#clip430)" style="stroke:#000000; stroke-linecap:round; stroke-linejoin:round; stroke-width:4; stroke-opacity:1; fill:none" points="2283.17,178.271 2449.62,178.271 2449.62,136.799 2283.17,136.799 2283.17,178.271 "></polyline>
<path clip-path="url(#clip430)" d="M2491.2 177.223 Q2489.4 181.852 2487.69 183.264 Q2485.97 184.676 2483.1 184.676 L2479.7 184.676 L2479.7 181.112 L2482.2 181.112 Q2483.96 181.112 2484.93 180.278 Q2485.9 179.445 2487.08 176.343 L2487.85 174.399 L2477.36 148.889 L2481.88 148.889 L2489.98 169.167 L2498.08 148.889 L2502.59 148.889 L2491.2 177.223 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path><path clip-path="url(#clip430)" d="M2509.88 170.88 L2517.52 170.88 L2517.52 144.515 L2509.21 146.181 L2509.21 141.922 L2517.48 140.255 L2522.15 140.255 L2522.15 170.88 L2529.79 170.88 L2529.79 174.815 L2509.88 174.815 L2509.88 170.88 Z" fill="#000000" fill-rule="nonzero" fill-opacity="1"></path></svg>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>